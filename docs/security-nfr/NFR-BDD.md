### 1. Защита от Brute-Force
Feature: Защита от Brute-Force (NFR-01)
Scenario: Позитивный сценарий (Срабатывание блокировки)
	Given Пользователь с IP
	And Учетная запись существует
	When Пользователь совершает 5 неудачных попыток входа в течение 5 минут
	Then Система должна вернуть ошибку "Слишком много попыток"
	And Система должна заблокировать IP на 10 минут

### 2. Унификация тела ответа аутентификации
Feature: Унификация тела ответа аутентификации (NFR-02)
Scenario: Унифицированный ответ для разных типов ошибки входа
	Given Конечная точка '/api/login'
	When Я отправляю запрос с неверным логином
	And Я отправляю запрос с верным логином, но неверным паролем
	Then Оба ответа должны иметь статус 401 Unauthorized
	And Тело ответа (JSON payload) для обеих ошибок должно быть абсолютно идентично: {"error": "Invalid credentials"}

### 3. Отзыв сессий при смене пароля
Feature: Мгновенный отзыв сессий (NFR-05)
Scenario: Отзыв сессии после смены пароля
	Given Пользователь 'user-A' вошел в систему и имеет активный access-токен 'T1'
	When Пользователь 'user-A' успешно меняет свой пароль
	And С момента смены пароля прошло 0.5 секунды
	Then Запрос с использованием токена 'T1' должен вернуть ошибку 401 Unauthorized
	And Общая задержка отзыва сессии не должна превышать 1 секунду

### 4. Минимизация хранения ПДн
Feature: Минимизация хранения ПДн (NFR-08)
Scenario: Анализ схемы базы данных
	Given Схема базы данных 'users'
	When Производится отсмотр полей, помеченных как ПДн
	Then Разрешены к хранению только поля 'user_id', 'user_name', 'hashed_password' и 'email'
	And Другие поля должны отсутствовать в схеме

### 5. Срок действия Access Token (негативный)
Feature: Срок жизни Access Token (NFR-04)
Scenario: Граничный случай (Истечение срока действия токена)
	Given Пользователь 'user-B' имеет валидный access-токен 'T2' с TTL 30 минут
	When Прошло 30 минут и 1 секунда с момента выдачи токена 'T2'
	And Пользователь пытается отправить запрос с токеном 'T2'
	Then Система должна вернуть ошибку 401 Unauthorized
	And Токен 'T2' должен быть помечен как невалидный
