
| ID     | Название                          | Описание                                                                                                                                                         | Метрика/порог                                                                                                                                                                                                           | Проверка                                                                               | Компонент                  | Приоритет |
|--------| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | -------------------------- | --------- |
| NFR-01 | Защита от Brute-Force             | Система должна применять механизм ограничения частоты попыток входа для предотвращения подбора паролей.                                                          | Блокировка на 10 минут после 5 неудачных попыток в течение 5 минут с одного IP или аккаунта.                                                                                                                            | Интеграционное тестирование (счетчик попыток), ручное тестирование (граничные случаи). | Gateway/Auth Service       | High      |
| NFR-02 | Унификация тела ответа            | Сообщения об ошибках при аутентификации (например, неверный логин или пароль) должны быть унифицированы, чтобы не раскрывать, какая именно часть данных неверна. | Тело ответа на неверный логин и неверный пароль должно быть абсолютно идентично                                                                                                                                         | Интеграционное тестирование (проверка ответов на разные сценарии ошибок)               | Auth Service               | High      |
| NFR-03 | Надежность логирования блокировок | Все критичные события должны быть зафиксированы в системе логирования.                                                                                           | % ошибок при записи события account-lockout: < 0.01%. Лог должен содержать user_id, timestamp, source_ip.                                                                                                               | Мониторинг логов                                                                       | Все бекэнд-сервисы         | Medium    |
| NFR-04 | Срок действия Access Token        | Ограниченный срок действия токена доступа                                                                                                                        | Время жизни access-токена 30 минут                                                                                                                                                                                      | Unit-тесты Auth Service (генерация токена), проверка сгенерированного токена.          | Auth Service               | Medium    |
| NFR-05 | Idle Timeout сессии               | Сессия должна автоматически отзываться после периода неактивности пользователя.                                                                                  | Idle-timeout 60 минут (максимальный период неактивности).                                                                                                                                                               | Интеграционное тестирование                                                            | Session Manager/Gateway    | Medium    |
| NFR-05 | Отзыв сессий при смене пароля     | При смене пароля все активные сессии пользователя должны быть отозваны.                                                                                          | Отзыв сессий должен происходить < 1 секунды после успешной смены пароля.                                                                                                                                                | Интеграционное тестирование (смена пароля + проверка токена)                           | Auth Service               | High      |
| NFR-06 | Сокрытие технической информации   | Ответы об ошибках и валидации не должны содержать технические детали, а коды 401/403 не должны давать уточнений.                                                 | HTTP-ответы с кодами 401/403 не должны включать стектрейсы, имена таблиц, пути к файлам или другую техническую информацию. Тело ответа 401 не должно различаться для "неверный логин" и "неверный пароль" (см. NFR-02). | Тестирование безопасности                                                              | Gateway/Все бэкенд-сервисы | High      |
| NFR-07 | Минимизация хранения ПДн          | Хранение только минимально-необходимых персональных данных (ПДн)                                                                                                 | В DB разрешено хранить только минимальный набор полей: user_id, user_name,<br>hashed_password, email                                                                                                                    | Анализ схемы базы данных                                                               | DB                         | High      |
