# ADR-001: <RateLimiting>
Дата: 2025-11-03
Статус: Accepted

## Context
Согласно NFR-01 (Защита от Brute-Force), система должна
блокировать пользователя после 5 неудачных попыток входа в
течение 5 минут. Угроза: R1 (Brute-Force аутентификации) (F1, Spoofing).

## Decision
Реализовать Rate Limiting не в самом сервисе аутентификации (P1), а на уровне API Gateway (Edge Trust Boundary), используя Redis для хранения счетчиков. Блокировка применяется по IP-адресу и логину пользователя одновременно.

## Consequences
Положительные:
1. Снижает нагрузку на сервисы авторизации (P1) и БД (D1).
2. Повышает эффективность защиты от распределенного Brute-Force (если учитывать оба счетчика).

Отрицательные:
1. Увеличивает зависимость от Redis.
2. Требует конфигурации Gateway для корректного считывания IP-адреса клиента.

## Links
- NFR-01 (ошибки RFC7807), NFR-05 (ротация секретов)
- R1 из Threat Model
- tests/test_auth.py
